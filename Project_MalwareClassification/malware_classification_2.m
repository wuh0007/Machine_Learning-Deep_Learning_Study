%% Initialization
close all
clear all
clc

%% Load Data
[M,N] = xlsread('trainLabels.xlsx');
load all_train_files.mat
label = zeros(10868,1);

%find corresponding label for each image pattern by searching filenames
for i = 1:length(filename)
     cell_str = strsplit(char(filename(1,i)),'.');
     [a,b]=find(strcmp(N,char(cell_str(:,1))));
     label(i)=M(a,b);
end
%image normalization
for idx = 1:size(all_images,1)
    idx
all_images_normalized(idx,:) = mat2gray(all_images(idx,:));
end

save train_data all_images all_images_normalized label
